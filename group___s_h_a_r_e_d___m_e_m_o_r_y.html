<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RZ/T2 Flexible Software Package Documentation: Shared Memory (r_shared_memory)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RZ/T2 Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v1.3.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___s_h_a_r_e_d___m_e_m_o_r_y.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Shared Memory (r_shared_memory)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga178a52ced35c42610cc25e74c253a369"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga178a52ced35c42610cc25e74c253a369">R_SHARED_MEMORY_Open</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl, <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__cfg__t">shared_memory_cfg_t</a> const *const p_cfg)</td></tr>
<tr class="separator:ga178a52ced35c42610cc25e74c253a369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5121208166bf470d1f8be5aa9175e003"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga5121208166bf470d1f8be5aa9175e003">R_SHARED_MEMORY_Read</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl, uint8_t *const p_dest, uint32_t const offset, uint32_t const bytes)</td></tr>
<tr class="separator:ga5121208166bf470d1f8be5aa9175e003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e1b9dfbef670952ccc4c528896d2781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga9e1b9dfbef670952ccc4c528896d2781">R_SHARED_MEMORY_Write</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl, uint8_t *const p_src, uint32_t const offset, uint32_t const bytes)</td></tr>
<tr class="separator:ga9e1b9dfbef670952ccc4c528896d2781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29111715e468d4fb8c5a89bec0fa1cf5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga29111715e468d4fb8c5a89bec0fa1cf5">R_SHARED_MEMORY_StatusGet</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl, <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__status__t">shared_memory_status_t</a> *p_status)</td></tr>
<tr class="separator:ga29111715e468d4fb8c5a89bec0fa1cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e40be0bd2bb6a2296ea081046ccb8a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga9e40be0bd2bb6a2296ea081046ccb8a7">R_SHARED_MEMORY_CallbackSet</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl, void(*p_callback)(<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> *), void const *const p_context, <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> *const p_callback_memory)</td></tr>
<tr class="separator:ga9e40be0bd2bb6a2296ea081046ccb8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b742d135513908117753fa6e6c45ce4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga4b742d135513908117753fa6e6c45ce4">R_SHARED_MEMORY_Close</a> (<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const p_api_ctrl)</td></tr>
<tr class="separator:ga4b742d135513908117753fa6e6c45ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Driver for the shared memory function on RZ microprocessor. This module implements the <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html">Shared Memory Interface</a>. </p>
<h1><a class="anchor" id="r-shared-memory-overview"></a>
Overview</h1>
<h2><a class="anchor" id="r-shared-memory-features"></a>
Features</h2>
<ul>
<li>Reads / Writes data on shared memory.</li>
<li>Supports configuring a user callback function, which will be invoked on following timing.<ul>
<li>When handshaking between two CPUs is finished</li>
<li>When written data to shared memory</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="r-shared-memory-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for r_shared_memory</h2>
The following build time configurations are defined in fsp_cfg/r_shared_memory_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Parameter Checking</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Default (BSP)</li>
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Default (BSP) </td><td>If selected code for parameter checking is included in the build. </td></tr>
</table>
 <h2>Configurations for Driver &gt; System &gt; Shared Memory Driver on r_shared_memory</h2>
This module can be added to the Stacks tab via New Stack &gt; Driver &gt; System &gt; Shared Memory Driver on r_shared_memory.<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Name</td><td>Name must be a valid C symbol</td><td>g_shared_memory0 </td><td>Module name. </td></tr>
<tr>
<td>Shared Memory Address</td><td>Value must be an integer</td><td></td><td>Specify the start address of the shared memory. </td></tr>
<tr>
<td>Shared Memory Size</td><td>Value must be greater than 0</td><td></td><td>Size of the shared memory (bytes). </td></tr>
<tr>
<td>Semaphore</td><td>Value must be an integer between 0 and 7</td><td>0 </td><td>Select a semaphore registor (SYTSEMFn). </td></tr>
<tr>
<td>Callback</td><td>Name must be a valid C symbol</td><td>NULL </td><td>A user callback function can be provided here. If this callback function is provided, it is called from the callback function of Inter-CPU IRQ Driver (RX) </td></tr>
</table>
</p>
<p>This module can be selected only when using Dual core devices.</p>
<h2><a class="anchor" id="r-shared-memory-clock-configuration"></a>
Clock Configuration</h2>
<p>This module does not require any specific clock settings.</p>
<h2><a class="anchor" id="r-shared-memory-pin-configuration"></a>
Pin Configuration</h2>
<p>This module does not use I/O pins.</p>
<h1><a class="anchor" id="r-shared-memory-usage_notes"></a>
Usage Notes</h1>
<h2>1. Generate stacks for each CPUs</h2>
<p>When using this module, it is necessary to configure shared memory driver stack on each CPU side.</p>
<h3>Example of stack configuration</h3>
<table class="doxtable">
<tr>
<th>Stack </th><th>Property </th><th>Value (CPU0) </th><th>Value (CPU1) </th><th>Note  </th></tr>
<tr>
<td rowspan="5">Shared Memory Driver </td><td>Name </td><td>g_shared_memory0 </td><td>g_shared_memory0 </td><td></td></tr>
<tr>
<td>Shared Memory Address </td><td colspan="2" align="center"><b>0x30100000</b> </td><td rowspan="3">Each value between CPU0 and CPU1 must be the same  </td></tr>
<tr>
<td>Shared Memory Size </td><td colspan="2" align="center"><b>256</b>  </td></tr>
<tr>
<td>Semaphore </td><td colspan="2" align="center"><b>0</b>  </td></tr>
<tr>
<td>Callback </td><td>shared_memory_callback </td><td>shared_memory_callback </td><td>User callback function  </td></tr>
<tr>
<td rowspan="3">Inter-CPU IRQ Driver (TX) </td><td>Name </td><td>g_icu_inter_cpu_irq0 </td><td>g_icu_inter_cpu_irq0 </td><td></td></tr>
<tr>
<td>Channel </td><td><b>0</b><sup>*1</sup> </td><td><b>1</b><sup>*2</sup> </td><td>*1 and *2 should be different channels  </td></tr>
<tr>
<td>Software Interrupt Priority </td><td colspan="2" align="center">Disabled </td><td>Locked  </td></tr>
<tr>
<td rowspan="3">Inter-CPU IRQ Driver (RX) </td><td>Name </td><td>g_icu_inter_cpu_irq1 </td><td>g_icu_inter_cpu_irq1 </td><td></td></tr>
<tr>
<td>Channel </td><td><b>1</b><sup>*2</sup> </td><td><b>0</b><sup>*1</sup> </td><td>Set to the same channel as TX of the another shared memory driver  </td></tr>
<tr>
<td>Software Interrupt Priority </td><td><b>Priority 12</b> </td><td><b>Priority 12</b> </td><td>Set valid value  </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>This module do not allocated an instance of the shared memory. If necessary, edit the linker script to protect the area.</dd></dl>
<h2>2. Prepare callback function</h2>
<p>Declare the callback function as follows:</p>
<div class="fragment"><div class="line">void &lt;user_callback_function_name&gt; (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> * p_args);</div></div><!-- fragment --><p>This callback function is invoked when the handshaking is completed and data is written. <code>shared_memory_ready_t state</code> in <code><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a></code> is useful to separate these cases.</p>
<h2>3. Use API function</h2>
<h3>a) Open operation</h3>
<p><a class="anchor" id="um_shared_memory_semaphore"></a> To use shared memory, <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga178a52ced35c42610cc25e74c253a369">R_SHARED_MEMORY_Open()</a> needs to be invoked on each CPU.</p>
<p>The driver determines if both drivers are open by accessing the shared memory space. Later opened driver sends an interrupt signal to the another CPU and the callback function is invoked.</p>
<div class="image">
<object type="image/svg+xml" data="r_shared_memory_open.svg">r_shared_memory_open.svg</object>
<div class="caption">
Open operation</div></div>
 <dl class="section attention"><dt>Attention</dt><dd>Do not write or erase data of the shared memory area by outside this module.</dd></dl>
<h3>b) Read / Write operation</h3>
<p><a class="anchor" id="um_shared_memory_boundary"></a><a class="anchor" id="um_shared_memory_read_write_cpu0"></a><a class="anchor" id="um_shared_memory_read_write_cpu1"></a> When one driver writes data to the shared memory with <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga9e1b9dfbef670952ccc4c528896d2781">R_SHARED_MEMORY_Write()</a>, it sends an interrupt signal to the another CPU and the callback function is invoked to notify the completion of data writing.</p>
<p>The another driver reads out the data via <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga5121208166bf470d1f8be5aa9175e003">R_SHARED_MEMORY_Read()</a>.</p>
<div class="image">
<object type="image/svg+xml" data="r_shared_memory_rw.svg">r_shared_memory_rw.svg</object>
<div class="caption">
Read / Write operation</div></div>
 <h3>c) Check the state of drivers</h3>
<p><a class="anchor" id="um_shared_memory_statusget_cpu0"></a><a class="anchor" id="um_shared_memory_statusget_cpu1"></a> <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga29111715e468d4fb8c5a89bec0fa1cf5">R_SHARED_MEMORY_StatusGet()</a> provides an interface to get the status of the driver.</p>
<h1><a class="anchor" id="r-shared-memory-examples"></a>
Examples</h1>
<h2><a class="anchor" id="r-shared-memory-examples-basic"></a>
Basic Example</h2>
<p>This is a basic example of minimal use of the shared memory module in CPU0 application.</p>
<div class="fragment"><div class="line"><span class="keyword">volatile</span> <span class="keywordtype">bool</span> g_shared_memory_data_receive_flag = <span class="keyword">false</span>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_shared_memory_basic_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>              err;</div><div class="line">    <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__status__t">shared_memory_status_t</a> status;</div><div class="line">    uint32_t               offset = 0;</div><div class="line">    uint8_t                transmit_buffer[SHARED_MEMORY_SIZE] = {0};</div><div class="line">    uint8_t                receive_buffer[SHARED_MEMORY_SIZE]  = {0};</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; SHARED_MEMORY_SIZE; i++)</div><div class="line">    {</div><div class="line">        transmit_buffer[i] = (uint8_t) i;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Open the driver. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga178a52ced35c42610cc25e74c253a369">R_SHARED_MEMORY_Open</a>(&amp;g_shared_memory0_ctrl, &amp;g_shared_memory0_cfg);</div><div class="line">    handle_error(err);</div><div class="line"></div><div class="line">    <span class="comment">/* Enable interrupt. */</span></div><div class="line">    __asm <span class="keyword">volatile</span> (<span class="stringliteral">&quot;cpsie i&quot;</span>);</div><div class="line">    __asm <span class="keyword">volatile</span> (<span class="stringliteral">&quot;isb&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">/* Wait until the driver of CPU1 opens. */</span></div><div class="line">    <span class="keywordflow">do</span></div><div class="line">    {</div><div class="line">        err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga29111715e468d4fb8c5a89bec0fa1cf5">R_SHARED_MEMORY_StatusGet</a>(&amp;g_shared_memory0_ctrl, &amp;status);</div><div class="line">        handle_error(err);</div><div class="line">    } <span class="keywordflow">while</span> (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ggae7a1de421a15ededd01891a6209216dda6a48d9e62b10a9eb867ee4bc985624ec">SHARED_MEMORY_STATE_READY_TO_WRITE</a> != status.<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a3a102af2624eb62ed7d3ff3d80549d63">state</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Write data to the shared memory. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga9e1b9dfbef670952ccc4c528896d2781">R_SHARED_MEMORY_Write</a>(&amp;g_shared_memory0_ctrl, transmit_buffer, offset, SHARED_MEMORY_SIZE);</div><div class="line">    handle_error(err);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (!g_shared_memory_data_receive_flag)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Wait until the driver of CPU1 writes data. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    g_shared_memory_data_receive_flag = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Read data from the shared memory. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga5121208166bf470d1f8be5aa9175e003">R_SHARED_MEMORY_Read</a>(&amp;g_shared_memory0_ctrl, receive_buffer, offset, SHARED_MEMORY_SIZE);</div><div class="line">    handle_error(err);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> example_callback (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> * p_args)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ggae7a1de421a15ededd01891a6209216ddab05cc78d387236941f7e9682ce5b6ff2">SHARED_MEMORY_STATE_READY_TO_READ_WRITE</a> == p_args-&gt;<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#acc2bd63934ecf9e1e15936cf051b0f6c">state</a>)</div><div class="line">    {</div><div class="line">        g_shared_memory_data_receive_flag = <span class="keyword">true</span>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* do nothing */</span></div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p> This is a basic example of minimal use of the shared memory module in CPU1 application.</p>
<div class="fragment"><div class="line"><span class="keyword">volatile</span> <span class="keywordtype">bool</span> g_shared_memory_data_receive_flag = <span class="keyword">false</span>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_shared_memory_basic_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line">    uint32_t  offset = 0;</div><div class="line">    uint8_t   transmit_buffer[SHARED_MEMORY_SIZE] = {0};</div><div class="line">    uint8_t   receive_buffer[SHARED_MEMORY_SIZE]  = {0};</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; SHARED_MEMORY_SIZE; i++)</div><div class="line">    {</div><div class="line">        transmit_buffer[i] = (uint8_t) ~i;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Open the driver. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga178a52ced35c42610cc25e74c253a369">R_SHARED_MEMORY_Open</a>(&amp;g_shared_memory0_ctrl, &amp;g_shared_memory0_cfg);</div><div class="line">    handle_error(err);</div><div class="line"></div><div class="line">    <span class="comment">/* Enable interrupt. */</span></div><div class="line">    __asm <span class="keyword">volatile</span> (<span class="stringliteral">&quot;cpsie i&quot;</span>);</div><div class="line">    __asm <span class="keyword">volatile</span> (<span class="stringliteral">&quot;isb&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (!g_shared_memory_data_receive_flag)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Wait until the driver of CPU0 writes data. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    g_shared_memory_data_receive_flag = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">    <span class="comment">/* Read data from the shared memory. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga5121208166bf470d1f8be5aa9175e003">R_SHARED_MEMORY_Read</a>(&amp;g_shared_memory0_ctrl, receive_buffer, offset, SHARED_MEMORY_SIZE);</div><div class="line">    handle_error(err);</div><div class="line"></div><div class="line">    <span class="comment">/* Write data to the shared memory. */</span></div><div class="line">    err = <a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y.html#ga9e1b9dfbef670952ccc4c528896d2781">R_SHARED_MEMORY_Write</a>(&amp;g_shared_memory0_ctrl, transmit_buffer, offset, SHARED_MEMORY_SIZE);</div><div class="line">    handle_error(err);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> example_callback (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> * p_args)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ggae7a1de421a15ededd01891a6209216ddab05cc78d387236941f7e9682ce5b6ff2">SHARED_MEMORY_STATE_READY_TO_READ_WRITE</a> == p_args-&gt;<a class="code" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#acc2bd63934ecf9e1e15936cf051b0f6c">state</a>)</div><div class="line">    {</div><div class="line">        g_shared_memory_data_receive_flag = <span class="keyword">true</span>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* do nothing */</span></div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2 class="groupheader">Function Documentation</h2>
<a id="ga178a52ced35c42610cc25e74c253a369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga178a52ced35c42610cc25e74c253a369">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_Open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_Open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__cfg__t">shared_memory_cfg_t</a> const *const&#160;</td>
          <td class="paramname"><em>p_cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens the shared memory driver. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#af5dd5002759eb36d18b9c90a0fcaa67f">shared_memory_api_t::open()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Module opened successfully. </td></tr>
    <tr><td class="paramname">FSP_ERR_ALREADY_OPEN</td><td>Module is already open. </td></tr>
    <tr><td class="paramname">FSP_ERR_IN_USE</td><td>Semaphore registor selected in configuration is in use. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Parameter check failure due to one or more reasons below:<ol type="1">
<li>p_api_ctrl or p_cfg is NULL.</li>
<li>extended parameter is NULL.</li>
<li>Callback parameter is NULL. </li>
</ol>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See <a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html">Common Error Codes</a> or functions called by this function for other possible return codes. This function calls:<ul>
<li><a class="el" href="group___i_c_u___i_n_t_e_r___c_p_u___i_r_q___a_p_i.html#aff168569493759a5cb37983080894447">icu_inter_cpu_irq_api_t::open</a></li>
<li><a class="el" href="group___i_c_u___i_n_t_e_r___c_p_u___i_r_q___a_p_i.html#a048aee24c3dc9989c7a4fe1927973dff">icu_inter_cpu_irq_api_t::generate</a> </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga5121208166bf470d1f8be5aa9175e003"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5121208166bf470d1f8be5aa9175e003">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_Read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t const&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t const&#160;</td>
          <td class="paramname"><em>bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Performs a read from the shared memory. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a7399460ad7fe0318cb9db5aa17a2ab25">shared_memory_api_t::read()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Function executed without issue </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>p_api_ctrl or p_dest is NULL. </td></tr>
    <tr><td class="paramname">FSP_ERR_INVALID_ARGUMENT</td><td>Invalid input parameter. </td></tr>
    <tr><td class="paramname">FSP_ERR_IN_USE</td><td>Another transfer was in progress. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9e1b9dfbef670952ccc4c528896d2781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e1b9dfbef670952ccc4c528896d2781">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_Write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t const&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t const&#160;</td>
          <td class="paramname"><em>bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Performs a write to the shared memory. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a7c79d9462a3d0db0676797b45f7da9d5">shared_memory_api_t::write()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Function executed without issue. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>p_api_ctrl or p_src is NULL. </td></tr>
    <tr><td class="paramname">FSP_ERR_INVALID_ARGUMENT</td><td>Invalid input parameter. </td></tr>
    <tr><td class="paramname">FSP_ERR_IN_USE</td><td>Another transfer was in progress. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga29111715e468d4fb8c5a89bec0fa1cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29111715e468d4fb8c5a89bec0fa1cf5">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_StatusGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_StatusGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__status__t">shared_memory_status_t</a> *&#160;</td>
          <td class="paramname"><em>p_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provides driver status. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a7c9e544607d79137f3d195a3564e6920">shared_memory_api_t::statusGet()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Status is stored in p_status. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>p_api_ctrl or p_status is NULL. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9e40be0bd2bb6a2296ea081046ccb8a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e40be0bd2bb6a2296ea081046ccb8a7">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_CallbackSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_CallbackSet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> *)&#160;</td>
          <td class="paramname"><em>p_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *const&#160;</td>
          <td class="paramname"><em>p_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#structshared__memory__callback__args__t">shared_memory_callback_args_t</a> *const&#160;</td>
          <td class="paramname"><em>p_callback_memory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the user callback and has option of providing memory for callback structure. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a5a9759ff64d18a23271b6a89c574c328">shared_memory_api_t::callbackSet</a></p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Callback updated successfully. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>A required pointer is NULL. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>The control block has not been opened. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4b742d135513908117753fa6e6c45ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4b742d135513908117753fa6e6c45ce4">&#9670;&nbsp;</a></span>R_SHARED_MEMORY_Close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> R_SHARED_MEMORY_Close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#ga86147394ad0075d6e745db4db4f4c688">shared_memory_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_api_ctrl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes the SHARED_MEMORY. Implements <a class="el" href="group___s_h_a_r_e_d___m_e_m_o_r_y___a_p_i.html#a26aac04753c3af97cd7fd51a94718657">shared_memory_api_t::close()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Module closed successfully. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>p_api_ctrl is NULL. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v1.3.0 User's Manual Copyright © (2023) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
